<testData xmlns:ccg="/fw/ccg/XMLBeanParser" xmlns:wrap="/fw/ccg/XMLBeanParser/wrap">

	<testSuite name="rest-test-suites">
	
		<testCase name="testPost">
			<description>Test post api invocation</description>
			<wrap:steps>
				<ccg:rest-invoke-post uri="/emp/save">
					<body><![CDATA[
						{
							"name" : "Emp1",
							"address": "some address"
						}
					]]></body>
				</ccg:rest-invoke-post>
				
				<ccg:set expression="emp1_id" value="attr: response | xpath: //id"/>

				<ccg:assert-equals actual="prop: attr.result.statusCode" expected="int: 200"/>

				<ccg:rest-invoke-post uri="/emp/save">
					<body><![CDATA[
						{
							"name" : "Emp2",
							"address": "some address"
						}
					]]></body>
				</ccg:rest-invoke-post>
				
				<ccg:set expression="emp2_id" value="attr: response | xpath: //id"/>
				<ccg:assert-equals actual="prop: attr.result.statusCode" expected="int: 200"/>
			</wrap:steps>
		</testCase>

		<testCase name="testGet" dependencies="testPost">
			<description>Tests get api invocation</description>

			<ccg:rest-invoke-get uri="/emp/get/{id}">
				<pathVariable name="id">${attr.emp2_id}</pathVariable>
			</ccg:rest-invoke-get>
			
			<ccg:assert-equals actual="xpath: /attr/response//name" expected="Emp2"/>
		</testCase>

		<testCase name="testDelete" dependencies="testPost">
			<description>Tests delete api invocation</description>

			<ccg:rest-invoke-delete uri="/emp/delete/{id}">
				<pathVariable name="id">${attr.emp2_id}</pathVariable>
			</ccg:rest-invoke-delete>
			
			<ccg:assert-equals actual="prop: attr.result.statusCode" expected="int: 200"/>
			
			<ccg:rest-invoke-get uri="/emp/get/{id}">
				<pathVariable name="id">${attr.emp2_id}</pathVariable>
			</ccg:rest-invoke-get>
			
			<!-- As emp2 is deleted, get should result in 400 error -->
			<ccg:assert-equals actual="prop: attr.result.statusCode" expected="int: 400"/>
		</testCase>

		<testCase name="testMultiPart" dependencies="testPost">
			<description>Tests multi part post request</description>

			<ccg:rest-invoke-multipart-post uri="/emp/saveWithFile">
				<part name="details">
					<value>
						{
							"name" : "Emp3",
							"address": "some address"
						}
					</value>
				</part>

				<attachment name="file" file="file:./src/test/resources/testFile.txt"/>				
			</ccg:rest-invoke-multipart-post>
			
			<ccg:assert-equals actual="prop: attr.result.statusCode" expected="int: 200"/>
			
			<ccg:set expression="emp3_id" value="attr: response | xpath: //id"/>
			
			<ccg:rest-invoke-get-file uri="/emp/getFile/{id}">
				<pathVariable name="id">${attr.emp3_id}</pathVariable>
			</ccg:rest-invoke-get-file>
			
			<ccg:loadText resource="file:${attr.response}" contextAttribute="outputContent"/>
			
			<ccg:assert-equals actual="attr: outputContent" expected="This is simple test file for upload."/>
		</testCase>
	</testSuite>
</testData>